<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>DGUV Management System</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <script>
    function toggleBlock(id) {
      const panel = document.getElementById(id).parentElement;
      panel.classList.toggle("open");
    }
  </script>
</head>
<body>
  <header>
    <h1>DGUV Management System</h1>
    <div class="logout">
      ğŸ‘¤ {{ benutzername }} 
      <a href="{{ url_for('logout') }}">ğŸ”“ Logout</a>     
    </div>
  </header>

  <div class="datum">ğŸ“… Heute ist: {{ heute }}</div>

  <div class="grid-container">
    <!-- ğŸ”´ Rot -->
    <div class="panel">
      <div class="panel-header" onclick="toggleBlock('rot')">ğŸ”´ ÃœberfÃ¤llig ({{ anzahl_rot }})</div>
      <div class="panel-content" id="rot">
        <table>
          <thead><tr><th>ID</th><th>GerÃ¤t</th><th>Abteilung</th><th>FÃ¤llig</th></tr></thead>
          <tbody>
            {% for eintrag in rot %}
            <tr><td>{{ eintrag.id }}</td><td>{{ eintrag.geraet }}</td><td>{{ eintrag.abteilung }}</td><td>{{ eintrag.naechste }}</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

    <!-- ğŸŸ¡ Gelb -->
    <div class="panel">
      <div class="panel-header" onclick="toggleBlock('gelb')">ğŸŸ¡ DemnÃ¤chst ({{ anzahl_gelb }})</div>
      <div class="panel-content" id="gelb">
        <table>
          <thead><tr><th>ID</th><th>GerÃ¤t</th><th>Abteilung</th><th>FÃ¤llig</th></tr></thead>
          <tbody>
            {% for eintrag in gelb %}
            <tr><td>{{ eintrag.id }}</td><td>{{ eintrag.geraet }}</td><td>{{ eintrag.abteilung }}</td><td>{{ eintrag.naechste }}</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

    <!-- ğŸŸ¢ GrÃ¼n -->
    <div class="panel">
      <div class="panel-header" onclick="toggleBlock('gruen')">ğŸŸ¢ Nicht fÃ¤llig ({{ anzahl_gruen }})</div>
      <div class="panel-content" id="gruen">
        <table>
          <thead><tr><th>ID</th><th>GerÃ¤t</th><th>Abteilung</th><th>FÃ¤llig</th></tr></thead>
          <tbody>
            {% for eintrag in gruen %}
            <tr><td>{{ eintrag.id }}</td><td>{{ eintrag.geraet }}</td><td>{{ eintrag.abteilung }}</td><td>{{ eintrag.naechste }}</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

    <!-- ğŸ“¦ Ersatzteile -->
    <div class="panel">
      <div class="panel-header" onclick="toggleBlock('lager')">ğŸ“¦ Ersatzteillager</div>
      <div class="panel-content" id="lager">
        <table>
          <thead><tr><th>Teil</th><th>Bestand</th><th>Typ</th><th>Aktion</th></tr></thead>
          <tbody>
            {% for teil in ersatzteile %}
            <tr>
              <td>{{ teil.teil }}</td>
              <td>{{ teil.bestand }}</td>
              <td>{{ teil.geraetetyp }}</td>
              <td>
                <form action="{{ url_for('update_lager') }}" method="POST">
                  <input type="hidden" name="teil" value="{{ teil.teil }}">
                  <button type="submit" name="aktion" value="+">+</button>
                  <button type="submit" name="aktion" value="-">â€“</button>
                </form>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>

        <h3>â• Neues Teil</h3>
        <form action="{{ url_for('add_teil') }}" method="POST" class="form-inline">
          <input name="new_name" placeholder="Teilname" required>
          <input name="new_bestand" placeholder="Bestand" type="number" required>
          <input name="new_typ" placeholder="GerÃ¤tetyp" required>
          <button type="submit">HinzufÃ¼gen</button>
        </form>
      </div>
    </div>
  </div>

  <!-- ğŸ“‚ Datenbank hochladen (zentriert, aufklappbar) -->
  <div class="panel upload-panel">
    <div class="panel-header" onclick="toggleBlock('upload')">ğŸ“‚ Datenbank hochladen</div>
    <div class="panel-content" id="upload">
      <form action="{{ url_for('upload_datenbank') }}" method="post" enctype="multipart/form-data">
        <input type="file" name="datenbank" accept=".xml" required>
        <button type="submit">Hochladen</button>
      </form>
    </div>
  </div>
</body>
</html>



